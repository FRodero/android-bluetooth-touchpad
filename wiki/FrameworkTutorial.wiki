=Framework Tutorial=

===Information===

This project is part of my Bachelor Thesis: "Implementation of a Bluetooth touchpad based on Android OS" at the [http://www13.in.tum.de/startseite/ Chair of Operating Systems, TU Munich.] You could download it [http://android-bluetooth-touchpad.googlecode.com/svn/trunk/%20android-bluetooth-touchpad/BTTouchpad/thesis/ here]. I will direct you to it whenever more information is needed.

==1. Requirements==
It is very important to check the [http://code.google.com/p/android-bluetooth-touchpad/wiki/Requirements requirements section]. For this tutorial I will use Ubuntu on the computer host side and a rooted Nexus One running Android, version 2.3.6. 

==2. Pairing==

You have to pair the phone and the host. Then you have to mark the phone as trusted on the host side.

===A) On Nexus ===
Press the menu button -> Settings -> Wireless & networks -> Bluetooth Settings. Turn on Bluetooth and make it discoverable. (It lasts couple a minutes.) 

===B) On Ubuntu===
Install and open blueman. (sudo apt-get install blueman) Click on "Search". After the device is found right click on it and then "Pair". Confirm the pairing request on both phone and computer. Right click on the device again and then click on "Trust". Done.

==3. Check out the Sample Code project==
Check out the Sample Code project in Eclipse. SVN check out: http://android-bluetooth-touchpad.googlecode.com/svn/trunk/%20android-bluetooth-touchpad/SampleCode/

==4. The Manifest==
In the Manifest the following permissions are declared: <code language="xml">
<uses-permission android:name="android.permission.BLUETOOTH"/>
<uses-permission android:name="android.permission.BLUETOOTH_ADMIN"/>
</code>

==5. The Bluetooth HID Framework Code ==

The Framework code is in the package tum.betriebsysteme.kostadinov.btframework. In the /doc dir you could also find the framework documentation. 

==6. The Executable==

The Linux executable, which is to be deployed and run from the console is placed in the /asset dir. Read chapter 5 in the [http://android-bluetooth-touchpad.googlecode.com/svn/trunk/%20android-bluetooth-touchpad/BTTouchpad/thesis/ thesis] to find out more.

==7. UI==
In main.xml we define very simple UI with three buttons: 
<code language="xml"><?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<Button 
	android:layout_width="fill_parent"
    android:layout_height="100dip"
    android:text="Add service record."
    android:id="@+id/add_service_button"
/>    
<Button 
	android:layout_width="fill_parent"
    android:layout_height="100dip"
    android:text="Connect to device"
    android:id="@+id/connect_to_device_button"
/>
<Button 
	android:layout_width="fill_parent"
    android:layout_height="100dip"
    android:text="Send message"
    android:id="@+id/send_message_button"
/>
</LinearLayout>
</code>

==8. Implementation== 
===A) onCreate()===
<code language="java">
public class SampleCodeActivity extends Activity implements OnClickListener, SDPStateListener, EventListener {
  
	private boolean registered = false;
	private Context context;
	
	private SDPRegister sdpRegister;
	private SocketThread l2capSocket1;
	private SocketThread l2capSocket2;
	private Handler handler;
		
	private static final CharSequence hello_message = "helloandroidbluetooth";
	
	/** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        
        sdpRegister = new SDPRegister(this,this);
        l2capSocket1 = new SocketThread(this);
        l2capSocket2 = new SocketThread(this);
        
        findViewById(R.id.add_service_button).setOnClickListener(this);
        findViewById(R.id.connect_to_device_button).setOnClickListener(this);
        findViewById(R.id.send_message_button).setOnClickListener(this);
        
        handler = new Handler();
        context = this;
    }
}
</code>